<div class="briefing-card">
    <h2>PD Beschrijving Protocol</h2>
    <div style="font-size: 13px; line-height: 1.5; color: #444;">
        <p><strong>AFSPRAKEN VOOR DE MELDING:</strong></p>
        <ul style="padding-left: 20px;">
            <li><strong>Positie:</strong> Start altijd met: "Ik stond..."</li>
            <li><strong>Kaal decor:</strong> Beschrijf in de <u>tegenwoordige tijd</u> (muur, regenpijp).</li>
            <li><strong>Sporen:</strong> Beschrijf in de <u>verleden tijd</u> (objecten/vlekken).</li>
            <li><strong>Objectiviteit:</strong> Benoem <strong>geen</strong> namen van sporen. Beschrijf wat je ziet (bijv: "Een zwart metalen voorwerp", "Een rode vloeistof").</li>
            <li><strong>Volgorde:</strong> Van links naar rechts, van groot naar klein.</li>
            <li><strong>Onderwerp:</strong> Het element is altijd het onderwerp van de zin.</li>
        </ul>
    </div>
    </div>

<script type="module">
    // ... Firebase configuratie blijft gelijk ...

    // De sporenlijst is nu geanonimiseerd
    const sporenLijst = [
        { id: 'pistool', name: 'Spoor A', img: '9mm pistol top down.png', size: 110, forbidden: ['pistool', 'wapen', 'revolver'] },
        { id: 'huls', name: 'Spoor B', img: 'Bullet casing isolated.png', size: 35, forbidden: ['huls', 'patroon'] },
        { id: 'bloed', name: 'Spoor C', img: 'Blood splatter top view.png', size: 160, forbidden: ['bloed', 'bloedvlek', 'bloedspoor'] },
        { id: 'schoen', name: 'Spoor D', img: 'Shoe print texture.png', size: 90, forbidden: ['schoen', 'afdruk', 'voetafdruk'] }
    ];

    window.sendMsg = () => {
        const input = document.getElementById('msgInput');
        const msg = input.value.trim().toLowerCase();
        
        // 1. Check op waarnemingswerkwoorden
        const verbodenWerkwoorden = /\b(zie|ziet|zag|kijk|kijkt|bekijk|bekijkt)\b/gi;
        if(verbodenWerkwoorden.test(msg)) {
            return alert("⚠️ PROTOCOL FOUT: Geen waarnemingswerkwoorden gebruiken.");
        }

        // 2. Check op conclusies (verboden namen van sporen)
        const alleVerbodenWoorden = sporenLijst.flatMap(s => s.forbidden);
        for(let woord of alleVerbodenWoorden) {
            if(msg.includes(woord)) {
                return alert("⚠️ PROTOCOL FOUT: Trek geen conclusies. Beschrijf alleen het uiterlijk van het voorwerp (bijv. 'een metalen voorwerp' ipv '" + woord + "').");
            }
        }

        // 3. Check op startzin
        if(!msg.startsWith("ik stond")) {
            return alert("⚠️ PROTOCOL FOUT: Begin met je positie ('Ik stond...')");
        }

        if(msg) {
            push(ref(db, 'feed'), { 
                sender: myName, msg: input.value, role: myRole, 
                view: mijnAanzicht ? mijnAanzicht.replace('.jpg', '').toUpperCase() : "OC",
                timestamp: serverTimestamp() 
            });
            input.value = '';
        }
    };

    // ... De rest van de functies (listenToSporen, etc.) blijven zoals in v4.0 ...
</script>
